<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <meta name="description"
        content="Phased Consistency Model">
  <meta name="keywords" content="Diffusion Model, Consistency Models">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Phased Consistency Modelt</title>

  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=G-PYVRSFMDRL"></script>
  <!-- <script async src="https://www.googletagmanager.com/gtag/js?id=G-Y5ZVQZ7NHC"></script> -->
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }

    gtag('js', new Date());

    gtag('config', 'G-PYVRSFMDRL');
  </script>

  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
        rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
        href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">
  <!-- <link rel="icon" href="./static/images/favicon.svg"> -->


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="static/js_slide/fontawesome.all.min.js"></script>
  <script src="static/js_slide/bulma-carousel.min.js"></script>
  <script src="static/js_slide/bulma-slider.min.js"></script>
  <script src="static/js_slide/index.js"></script>


  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>

  <!-- Vendor Stylesheets -->
  <!--=================js==========================-->
  <link rel="stylesheet" href="static/css/tab_gallery.css">
  <link rel="stylesheet" href="static/css/juxtapose.css">
  <link rel="stylesheet" href="static/css/image_card_fader.css">
  <link rel="stylesheet" href="static/css/image_card_slider.css">
</head>
<body>




<section class="hero">
  <div class="hero-body">
    <div class="container is-max-desktop">
      <div class="columns is-centered">
        <div class="column has-text-centered">
          <h1 class="title is-1 publication-title"><span style="color:#5e5ed2; font-weight: bold; font-style: italic"><strong>PCM</strong></span> : Phased Consistency Model</h1>
          <div class="is-size-5 publication-authors">
            <span class="author-block">
              <a href="https://g-u-n.github.io/">Fu-Yun Wang</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://drinkingcoder.github.io/">Zhaoyang Huang</a><sup>2</sup>,</span>
            <span class="author-block">
              <a href="https://scholar.google.com/citations?hl=en&user=-DqNXmAAAAAJ"> Alexander William Bergman</a><sup>3,6</sup>,</span>
            <span class="author-block">
              <a href="https://www.shendazhong.xyz/">Dazhong Shen</a><sup>4</sup>,</span>
            <span class="author-block">
              <a href="https://gaopengcuhk.github.io/">Peng Gao</a><sup>4</sup>,</span>
            <span class="author-block">
              <a href="https://mlingelbach.com/">Michael Lingelbach</a><sup>3,6</sup>,</span>
            <span class="author-block">
              <a href="https://keqiangsun.github.io/">Keqiang Sun</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://wkbian.github.io/">Weikang Bian</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://songguanglu.github.io/">Guanglu Song</a>5<sup></sup>,</span>
            <span class="author-block">
              <a href="https://liuyu.us/">Yu Liu</a><sup>4</sup>,</span>
            <span class="author-block">
              <a href="https://www.ee.cuhk.edu.hk/~hsli/">Hongsheng Li</a><sup>1</sup>,</span>
            <span class="author-block">
              <a href="https://www.ee.cuhk.edu.hk/~xgwang/">Xiaogang Wang</a><sup>1</sup></span>
            </div>
            <br>
          <div class="is-size-5 publication-authors">
            <span class="author-block"><sup>1</sup>MMLab, CUHK</span>
            <span class="author-block"><sup>2</sup>Avolution AI</span>
            <span class="author-block"><sup>3</sup>Hedra</span>
            <span class="author-block"><sup>4</sup>Shanghai AI Lab</span>
            <span class="author-block"><sup>5</sup>Sensetime Research</span>
            <span class="author-block"><sup>6</sup>Stanford University</span>
          </div>

          <div class="column has-text-centered">
            <div class="publication-links">
              <!-- PDF Link. -->
              <span class="link-block">
                <a href="https://g-u-n.github.io/assets/slides/pcm.pdf"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fas fa-file-pdf"></i>
                  </span>
                  <span>Paper</span>
                </a>
              </span>
              <span class="link-block">
                <a href="https://arxiv.org/abs/2405.18407"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
              <!-- Video Link. -->
              <span class="link-block">
                <a href="https://www.youtube.com/watch?v=B4ieLnS4MTY"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-youtube"></i>
                  </span>
                  <span>Video</span>
                </a>
              </span>
              <!-- Code Link. -->
              <span class="link-block">
                <a href="https://github.com/G-U-N/Phased-Consistency-Model"
                   class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                      <i class="fab fa-github"></i>
                  </span>
                  <span>Code</span>
                  </a>
              </span>  
              <!-- huggingface Link. -->
              <span class="link-block">
                <a href="https://huggingface.co/spaces/radames/Phased-Consistency-Model-PCM"
                   class="external-link button is-normal is-rounded is-dark">
                  <span>Huggingface Demo</span>
                  </a>
              </span>
            </div>

          </div>
        </div>
      </div>
    </div>
  </div>
</section>

<!--=================Teasers==========================-->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container is-max-desktop has-text-centered">
      <div class="tab_container">
        <div id="juxtapose-embed" data-startingposition="30%" data-animate="true" class="juxtapose"
          style="height: 512px; width: 512px;">
        </div>
        <div>
          <div id="juxtapose-hidden"></div>
        </div>
        <!-- Image text -->
        <div id="imgtext"></div>
      </div>

      <!-- The grid: four columns -->
      <div class="tab_row">
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/pcm1.png" onclick="tab_gallery_click('1');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/pcm2.png" onclick="tab_gallery_click('2');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/pcm3.png" onclick="tab_gallery_click('3');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/pcm4.png" onclick="tab_gallery_click('4');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/pcm5.png" onclick="tab_gallery_click('5');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/pcm6.png" onclick="tab_gallery_click('6');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/pcm7.png" onclick="tab_gallery_click('7');">
        </div>
        <div class="tab_column">
          <img src="freeu_img_vid/t2i/pcm8.png" onclick="tab_gallery_click('8');">
        </div>
      </div>
      <div class="content has-text-justified">
        <p>
          We show the design space of LCM is limited in three perspective. We propose <strong>PCM</strong>, generalizaing the design space and well tackling these limitations.
      </div>
    </div>
  </div>
</section>

<!--=================paper Video==========================-->
<section class="hero is-light is-small">
  <div class="columns is-centered has-text-centered"  style="margin-top: 10px; margin-bottom: 20px;">
    <div class="column is-three-fifths">
      <h2 class="title is-3">Video</h2>
      
      <div class="publication-video">
        <iframe width="560" height="315" src="https://www.youtube.com/embed/B4ieLnS4MTY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
      </div>
      
    </div>
  </div>
</section>


<!--=================Abstract==========================-->
<section class="section">
  <div class="container is-max-desktop">
    <!-- Abstract. -->
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Motivation</h2>
        <div class="content has-text-justified">
          <p>
            Consistency model~(CM) is a promising new family of generative models known for high-quality yet fast generation. Latent consistency model~(LCM) tried to extend it into the latent space for text-conditioned high-resolution generation. However, its results is not pleasant. In this work, we show that the current designs of LCM are flawed in three aspects. We propose Phased consistency model~(PCM), generalizing the design space of LCM and well tackling those limitations. Innovative strategies are proposed in both training and inference to improve the generation quality. Vast experimental results covering 1-step, 2-step, 4-step, 8-step, 16-step with widely applied Stable Diffusion and Stable Diffusion XL foundation models validate the advancements of PCM.        </div>
      </div>
    </div>
  </div>
</section>

<!--/ Framework. -->
<section class="section" style="margin-top:-120px;">
  <div class="container is-max-desktop">
    <div class="hero-body">
        <div class="section-title has-text-centered" >
          <h2 class="title is-3 is-centered">Motivation Summary Figure</h2>
        </div>
        <div class="columns is-centered has-text-centered">
          <div class="column">
            <div class="publication-img">
              <img id="architecture" src="freeu_img_vid/motivation.png" style="width:800px; margin-top:10px;margin-bottom:10px;"/>
            </div>
          </div>
        </div>
        <p>
          There are three main limitations for the latent consistency model.
          (1️) LCM can only accept CFG scale less than 2.  Lager values cause over exposure. LCM is insensitive to negative prompt.
          (2) LCM fails to produce consistent results with different inference steps. Its results are blurry when step is too large or too small.  
          (3) Loss term of LCM fails to achieve distribution consistency, produce bad results at low step regime.
          In this work, we investigate the reasons behind these limitations and propose PCM, which well tackles all these limitations.
        </p>
    </div>
  </div>
</section>



<!-- Diverse Relations -->
<section class="section" style="background-color: #f1f1f1;">
  <div class="container  style="margin-top:30px;">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Text to Image Qualitative Comparison</h2>
        <h2 class="subtitle has-text-centered">Presentation Video.</h2>

        <div class="publication-video">
        <iframe width="560" height="315" src="https://www.youtube.com/embed/B4ieLnS4MTY" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" allowfullscreen></iframe>
        </div>

        <h2 class="subtitle has-text-centered">Sample quality comparison of PCM and previous best methods.</h2>
        <!-- Supp Long Figures -->
        <div id="results-carousel-face" class="carousel results-carousel">
          <div class="item item-puppet">
            <div class="carousel-content">
              <img src="freeu_img_vid/t2i/sd_xl.png"
                      alt="Puppet."/>
            </div>
          </div>
          <div class="item item-round_bird">
            <div class="carousel-content">
              <img src="freeu_img_vid/t2i/sd_v15.png"
                      alt="Round-bird."/>
            </div>
          </div>
        </div>
        
        </div>
      </div>
    </div>
  </div>  
 
</section>


  


<!-- ControlNet -->
<section class="section">
  <div class="container  style="margin-top:30px;">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Gallery of Stable Diffusion v1-5 + PCM</h2>
        <h2 class="subtitle has-text-centered">Images generated by PCM</h2>

        <!-- Supp Long Figures -->
        <div id="results-carousel-face" class="carousel results-carousel">
          <div class="item item-sd_v15_1">
            <div class="carousel-content">
              <img src="freeu_img_vid/sd_v15/sd_v15_1.png"
                      alt="sd_v15_1step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sd_v15_2">
            <div class="carousel-content">
              <img src="freeu_img_vid/sd_v15/sd_v15_2.png"
                      alt="sd_v15_2step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sd_v15_3">
            <div class="carousel-content">
              <img src="freeu_img_vid/sd_v15/sd_v15_4.png"
                      alt="sd_v15_4step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sd_v15_4">
            <div class="carousel-content">
              <img src="freeu_img_vid/sd_v15/sd_v15_8.png"
                      alt="sd_v15_8step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sd_v15_5">
            <div class="carousel-content">
              <img src="freeu_img_vid/sd_v15/sd_v15_16.png"
                      alt="sd_v15_16step." style="width:800px;"/>
            </div>
          </div>
        </div>
        
        </div>
      </div>
    </div>
  </div>  
 
</section>



<!-- LCM -->
<section class="section" style="background-color: #f1f1f1;">
  <div class="container  style="margin-top:30px;">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Gallery of Stable Diffusion XL + PCM</h2>
        <h2 class="subtitle has-text-centered">Images generated by PCM</h2>

        <!-- Supp Long Figures -->
        <div id="results-carousel-face" class="carousel results-carousel">
          <div class="item item-sd_xl_1">
            <div class="carousel-content">
              <img src="freeu_img_vid/sd_xl/sd_xl_1.png"
                      alt="sd_xl_1step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sd_xl_2">
            <div class="carousel-content">
              <img src="freeu_img_vid/sd_xl/sd_xl_2.png"
                      alt="sd_xl_2step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sd_xl_3">
            <div class="carousel-content">
              <img src="freeu_img_vid/sd_xl/sd_xl_4.png"
                      alt="sd_xl_4step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sd_xl_4">
            <div class="carousel-content">
              <img src="freeu_img_vid/sd_xl/sd_xl_8.png"
                      alt="sd_xl_8step." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sd_xl_5">
            <div class="carousel-content">
              <img src="freeu_img_vid/sd_xl/sd_xl_16_1.png"
                      alt="sd_xl_16step_1." style="width:800px;"/>
            </div>
          </div>
          <div class="item item-sd_xl_6">
            <div class="carousel-content">
              <img src="freeu_img_vid/sd_xl/sd_xl_16_2.png"
                      alt="sd_xl_16step_2." style="width:800px;"/>
            </div>
          </div>
        </div>
        
        </div>
      </div>
    </div>
  </div>  
 
 
</section>



  
<!--=================t2v Results==========================-->
<section class="section">
  <div class="container  style="margin-top:30px;">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Text to Video</h2>
        <h2 class="subtitle has-text-centered">Video generation quality comparison with AnimateLCM in low-step regime.</h2>

        <!-- Supp Long Figures -->
        <div id="results-carousel-face" class="carousel results-carousel">
          <div class="item item-puppet">
            <div class="carousel-content">
              <video id="teaser" autoplay muted loop playsinline height="100%">
                <source src="freeu_img_vid/t2v/video_lion.mp4" 
                       alt="Puppet."/>
              </video>
            </div>
          </div>
          <div class="item item-round_bird">
            <div class="carousel-content">
              <video id="teaser" autoplay muted loop playsinline height="100%">
                <source src="freeu_img_vid/t2v/video_mountain.mp4" 
                        alt="Round-bird."/>
              </video>
            </div>
          </div>
          <div class="item item-round_bird">
            <div class="carousel-content">
              <video id="teaser" autoplay muted loop playsinline height="100%">
                <source src="freeu_img_vid/t2v/video_cat.mp4" 
                        alt="Round-bird."/>
              </video>
            </div>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>  
</section>


<!--=================t2v Results==========================-->
<section class="section" style="background-color: #f1f1f1;">
  <div class="container  style="margin-top:30px;">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Screen recording </h2>
        <h2 class="subtitle has-text-centered">Our model is stable for generating good-quality videos in 2 steps.</h2>

        <!-- Supp Long Figures -->
        <div id="results-carousel-face" class="carousel results-carousel">
          <div class="item item-puppet">
            <div class="carousel-content">
              <video id="teaser" autoplay muted loop playsinline height="100%">
                <source src="freeu_img_vid/t2v/case1x2.mp4" 
                       alt="Puppet."/>
              </video>
            </div>
          </div>
          <div class="item item-round_bird">
            <div class="carousel-content">
              <video id="teaser" autoplay muted loop playsinline height="100%">
                <source src="freeu_img_vid/t2v/case2x2.mp4" 
                        alt="Round-bird."/>
              </video>
            </div>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>  
</section>


<section class="section" id="BibTeX">
  <div class="container is-max-desktop content">
    <h2 class="title">BibTeX</h2>
    <pre><code>@article{wang2024phased,
  author    = {Fu-Yun Wang, Zhaoyang Huang, Alexander William Bergman, Dazhong Shen, Peng Gao, Michael Lingelbach3, Keqiang Sun1, Weikang Bian, Guanglu Song, Yu Liu, Hongsheng Li, Xiaogang Wang},
  title     = {Phased Consistency Model},
  year      = {2024},
}</code></pre>
  </div>
</section>

  
<footer class="footer">
  <div class="container">
    <div class="content has-text-centered">
<!--       <a class="icon-link"
         href="./static/videos/nerfies_paper.pdf">
        <i class="fas fa-file-pdf"></i>
      </a> -->
<!--       <a class="icon-link" href="https://github.com/keunhong" class="external-link" disabled>
        <i class="fab fa-github"></i>
      </a> -->
    </div>
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">
          <p>
            This website is licensed under a <a rel="license"
                                                href="http://creativecommons.org/licenses/by-sa/4.0/">Creative
            Commons Attribution-ShareAlike 4.0 International License</a>.
          </p>
        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Image Slider Javascripts -->
<!--=================Functions==========================-->
<script src="static/js/juxtapose.js"></script>

<script>
  var slider;
  let origImages = [
    { "src": "freeu_img_vid/t2i/lcm1.png", "label": "LCM", },
    { "src": "freeu_img_vid/t2i/pcm1.png", "label": "PCM", }
  ];

  let origOptions = {
    "makeResponsive": true,
    "showLabels": true,
    "mode": "horizontal",
    "showCredits": true,
    "animate": true,
    "startingPosition": "50"
  };

  const juxtaposeSelector = "#juxtapose-embed";
  const transientSelector = "#juxtapose-hidden";

  
  function tab_gallery_click(name) {
    // Get the expanded image
    let inputImage = {
      label: "LCM",
    };
    let outputImage = {
      label: "PCM",
    };

    inputImage.src = "freeu_img_vid/t2i/".concat("lcm",name, ".png")
    outputImage.src = "freeu_img_vid/t2i/".concat("pcm",name, ".png")

    let images = [inputImage, outputImage];
    let options = slider.options;
    options.callback = function (obj) {
      var newNode = document.getElementById(obj.selector.substring(1));
      var oldNode = document.getElementById(juxtaposeSelector.substring(1));
      console.log(obj.selector.substring(1));
      console.log(newNode.children[0]);
      oldNode.replaceChild(newNode.children[0], oldNode.children[0]);
      //newNode.removeChild(newNode.children[0]);

    };

    slider = new juxtapose.JXSlider(transientSelector, images, options);
  };

  (function () {
    slider = new juxtapose.JXSlider(
      juxtaposeSelector, origImages, origOptions);
    //document.getElementById("left-button").onclick = replaceLeft;
    //document.getElementById("right-button").onclick = replaceRight;
  })();
  // Get the image text
  var imgText = document.getElementById("imgtext");
  // Use the same src in the expanded image as the image being clicked on from the grid
  // expandImg.src = imgs.src;
  // Use the value of the alt attribute of the clickable image as text inside the expanded image
  imgText.innerHTML = name;
  // Show the container element (hidden with CSS)
  // expandImg.parentElement.style.display = "block";

  $(".flip-card").click(function () {
    console.log("fading in")
    div_back = $(this).children().children()[1]
    div_front = $(this).children().children()[0]
    // console.log($(this).children("div.flip-card-back"))
    console.log(div_back)
    $(div_front).addClass("out");
    $(div_front).removeClass("in");

    $(div_back).addClass("in");
    $(div_back).removeClass("out");

  });

  $(".flip-card").mouseleave(function () {
    console.log("fading in")
    div_back = $(this).children().children()[1]
    div_front = $(this).children().children()[0]
    // console.log($(this).children("div.flip-card-back"))
    console.log(div_back)
    $(div_front).addClass("in");
    $(div_front).removeClass("out");

    $(div_back).addClass("out");
    $(div_back).removeClass("in");

  });
</script>


</body>
</html>


